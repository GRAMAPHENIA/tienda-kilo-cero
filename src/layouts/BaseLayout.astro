---
import { ViewTransitions } from "astro:transitions";

export interface Props {
  title: string;
}

const { title } = Astro.props;
---

<!doctype html>
<html lang="es">
  <head>
    <meta charset="UTF-8" />
    <meta
      name="description"
      content="Tienda simple con integración de MercadoPago"
    />
    <meta name="viewport" content="width=device-width" />
    <link rel="icon" type="image/svg+xml" href="/favicon.svg" />
    <meta name="generator" content={Astro.generator} />
    <ViewTransitions />
    <title>{title}</title>
    <link rel="preconnect" href="https://fonts.googleapis.com" />
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin />
    <link
      href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700&family=Roboto:wght@400;500;700&display=swap"
      rel="stylesheet"
    />
    <script src="https://sdk.mercadopago.com/js/v2"></script>
  </head>
  <body
    class="bg-background text-text-primary font-body min-h-screen flex flex-col"
  >
    <header class="bg-transparent py-8 px-6 md:px-12">
      <div class="max-w-7xl mx-auto flex justify-between items-center">
        <h1
          class="text-3xl font-title font-light text-header-text tracking-wide"
        >
          <a
            href="/"
            class="hover:text-primary transition-colors duration-500 ease-out"
            >Tienda</a
          >
        </h1>

        <!-- Desktop Navigation -->
        <nav class="hidden md:flex items-center space-x-12">
          <a
            href="/productos"
            class="text-header-text hover:text-[#EC0B43] transition-all duration-500 ease-out text-lg font-light tracking-wide flex items-center"
          >
            <img src="/icons/store.svg" alt="Productos" class="w-5 h-5 mr-2" />
            Productos
          </a>
          <a
            href="/favoritos"
            class="text-header-text hover:text-[#EC0B43] transition-all duration-500 ease-out text-lg font-light tracking-wide flex items-center"
          >
            <img src="/icons/heart.svg" alt="Favoritos" class="w-5 h-5 mr-2" />
            Favoritos
          </a>
          <a
            href="/carrito"
            class="text-header-text hover:text-[#EC0B43] transition-all duration-500 ease-out text-lg font-light tracking-wide flex items-center"
          >
            <img
              src="/icons/shopping-cart.svg"
              alt="Carrito"
              class="w-5 h-5 mr-2"
            />
            Carrito
          </a>
        </nav>

        <!-- Mobile Menu Button -->
        <button
          id="mobile-menu-button"
          class="md:hidden text-header-text hover:text-primary transition-colors duration-300 p-2"
          aria-label="Toggle menu"
        >
          <svg
            class="w-8 h-8"
            fill="none"
            stroke="currentColor"
            viewBox="0 0 24 24"
          >
            <path
              stroke-linecap="round"
              stroke-linejoin="round"
              stroke-width="1.5"
              d="M4 6h16M4 12h16M4 18h16"></path>
          </svg>
        </button>
      </div>

      <!-- Mobile Navigation -->
      <nav
        id="mobile-menu"
        class="md:hidden mt-8 pb-8 border-t border-header-text/10 pt-8 hidden"
      >
        <div class="space-y-6">
          <a
            href="/productos"
            class="text-header-text hover:text-[#EC0B43] transition-colors duration-300 text-xl font-light tracking-wide py-2 flex items-center"
          >
            <img src="/icons/store.svg" alt="Productos" class="w-5 h-5 mr-3" />
            Productos
          </a>
          <a
            href="/favoritos"
            class="text-header-text hover:text-[#EC0B43] transition-colors duration-300 text-xl font-light tracking-wide py-2 flex items-center"
          >
            <img src="/icons/heart.svg" alt="Favoritos" class="w-5 h-5 mr-3" />
            Favoritos
          </a>
          <a
            href="/carrito"
            class="text-header-text hover:text-[#EC0B43] transition-colors duration-300 text-xl font-light tracking-wide py-2 flex items-center"
          >
            <img
              src="/icons/shopping-cart.svg"
              alt="Carrito"
              class="w-5 h-5 mr-3"
            />
            Carrito
          </a>
        </div>
      </nav>
    </header>
    <main class="flex-grow px-6 md:px-12 py-16 md:py-24">
      <div class="max-w-7xl mx-auto">
        <slot />
      </div>
    </main>
    <footer
      class="bg-transparent text-footer-text pt-24 pb-8 px-6 md:px-12 border-t border-header-text/10"
    >
      <div class="max-w-7xl mx-auto">
        <div
          class="grid grid-cols-1 md:grid-cols-3 gap-16 text-center md:text-left"
        >
          <div class="space-y-6">
            <h3 class="text-2xl font-light tracking-wide">Tienda</h3>
            <p class="text-sm leading-relaxed max-w-sm opacity-80">
              Descubrí nuestros productos y pagos seguros a través de
              MercadoPago.
            </p>
          </div>
          <div class="space-y-6">
            <h4 class="text-lg font-light tracking-wide">Navegación</h4>
            <ul class="space-y-4">
              <li>
                <a
                  href="/productos"
                  class="text-sm text-header-text hover:text-[#EC0B43] transition-colors duration-500 ease-out"
                  >Productos</a>
              </li>
              <li>
                <a
                  href="/carrito"
                  class="text-sm text-header-text hover:text-[#EC0B43] transition-colors duration-500 ease-out"
                  >Carrito</a>
              </li>
              <li>
                <a
                  href="/favoritos"
                  class="text-sm text-header-text hover:text-[#EC0B43] transition-colors duration-500 ease-out"
                  >Favoritos</a>
              </li>
              <li>
                <a
                  href="/checkout"
                  class="text-sm text-header-text hover:text-[#EC0B43] transition-colors duration-500 ease-out"
                  >Checkout</a>
              </li>
            </ul>
          </div>
          <div class="space-y-6">
            <h4 class="text-lg font-light tracking-wide">Conectá</h4>
            <ul class="space-y-4">
              <li>
                <a
                  href="#"
                  class="text-sm text-header-text hover:text-[#EC0B43] transition-colors duration-500 ease-out"
                  >Instagram</a>
              </li>
              <li>
                <a
                  href="#"
                  class="text-sm text-header-text hover:text-[#EC0B43] transition-colors duration-500 ease-out"
                  >Twitter</a>
              </li>
              <li>
                <a
                  href="#"
                  class="text-sm text-header-text hover:text-[#EC0B43] transition-colors duration-500 ease-out"
                  >LinkedIn</a>
              </li>
              <li></li>
            </ul>
          </div>
        </div>
        <div class="border-t border-header-text/10 mt-16 pt-8 text-center">
          <p class="text-xs opacity-60">2025 Tienda. Productos MUGA.</p>
          <a
            href="/reportar-bug"
            class="text-sm text-header-text hover:text-[#EC0B43] transition-colors duration-500 ease-out flex items-center justify-center mt-2"
          >
            <img src="/icons/bug.svg" alt="Bug" class="w-4 h-4 mr-2 text-xs" />
            Reportar Bug
          </a>
        </div>
      </div>
      <script src="/src/lib/clientUtils.js"></script>
      <script>
        if ("serviceWorker" in navigator) {
          navigator.serviceWorker
            .register("/sw.js")
            .then((reg) => console.log("Service Worker registrado:", reg))
            .catch((err) =>
              console.error("Error registrando Service Worker:", err)
            );
        }

        // Mobile menu functionality
        document.addEventListener("DOMContentLoaded", () => {
          const mobileMenuButton =
            document.getElementById("mobile-menu-button");
          const mobileMenu = document.getElementById("mobile-menu");

          if (mobileMenuButton && mobileMenu) {
            mobileMenuButton.addEventListener("click", () => {
              mobileMenu.classList.toggle("hidden");
              const isOpen = !mobileMenu.classList.contains("hidden");
              mobileMenuButton.setAttribute("aria-expanded", isOpen.toString());

              // Animate hamburger icon
              const icon = mobileMenuButton.querySelector("svg");
              if (icon) {
                if (isOpen) {
                  icon.innerHTML =
                    '<path stroke-linecap="round" stroke-linejoin="round" stroke-width="1.5" d="M6 18L18 6M6 6l12 12"></path>';
                } else {
                  icon.innerHTML =
                    '<path stroke-linecap="round" stroke-linejoin="round" stroke-width="1.5" d="M4 6h16M4 12h16M4 18h16"></path>';
                }
              }
            });

            // Close menu when clicking on a link
            mobileMenu.querySelectorAll("a").forEach((link) => {
              link.addEventListener("click", () => {
                mobileMenu.classList.add("hidden");
                mobileMenuButton.setAttribute("aria-expanded", "false");
                const icon = mobileMenuButton.querySelector("svg");
                if (icon) {
                  icon.innerHTML =
                    '<path stroke-linecap="round" stroke-linejoin="round" stroke-width="1.5" d="M4 6h16M4 12h16M4 18h16"></path>';
                }
              });
            });
          }
        });
      </script>
    </footer>
  </body>
</html>
